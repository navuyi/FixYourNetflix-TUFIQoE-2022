{"version":3,"file":"content.09957d909cfc8376778a.hot-update.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;AAaA;;;;;;;;;;AAfA;;;;;;;;;;;;;;;;;;;;;;;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACrDA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://fix-your-netflix-experiment-extension/./src/utils/keyboard_hotkeys/simulate_bitrate_menu_hotkeys.js","webpack://fix-your-netflix-experiment-extension/./src/pages/Content/QualityEnhancer.ts","webpack://fix-your-netflix-experiment-extension/./src/utils/classes/BitrateMenu.ts","webpack://fix-your-netflix-experiment-extension/./src/utils/html_element_extractors/get_bitrate_menu_elements.ts","webpack://fix-your-netflix-experiment-extension/webpack/runtime/getFullHash","webpack://fix-your-netflix-experiment-extension/webpack/runtime/harmony module decorator"],"sourcesContent":["\nexport const simulate_bitrate_menu_hotkey = () => {\n    document.dispatchEvent(\n        new KeyboardEvent(\"keydown\", {\n            key: \"S\",\n            altKey: true,\n            ctrlKey: true,\n            shiftKey: true,\n            bubbles: true,\n            code: \"KeyS\",\n            which: 83,\n            cancelable: true,\n            composed: true,\n            keyCode: 83\n        })\n    )\n}","import { BitrateMenu } from \"../../utils/classes/BitrateMenu\";\nimport { CustomLogger } from \"../../utils/classes/CustomLogger\";\nexport class QualityEnhancer {\n    constructor() {\n        this.init = async () => {\n            this.bitrate_menu.init();\n            window.document.onkeydown = async (e) => {\n                if (e.key === \"G\") {\n                    console.log(\"Resetting\");\n                    await this.reset_video_quality();\n                }\n            };\n        };\n        this.reset_video_quality = async () => {\n            const available_bitrates = this.bitrate_menu.get_available_bitrates();\n            const best = available_bitrates[available_bitrates.length - 1];\n            await this.bitrate_menu.set_bitrate(best);\n        };\n        this.logger = new CustomLogger(\"[QualityEnhancer]\");\n        this.bitrate_menu = new BitrateMenu();\n    }\n}\n","import { CustomLogger } from \"./CustomLogger\";\nimport { invoke_bitrate_menu_and_get_html_elements } from \"../html_element_extractors/get_bitrate_menu_elements\";\nimport { simulate_bitrate_menu_hotkey } from \"../keyboard_hotkeys/simulate_bitrate_menu_hotkeys\";\nexport class BitrateMenu {\n    constructor() {\n        /**\n         *  Invokes bitrate menu and assings bitrate menu's HTML elements\n         *  to instance attributes.\n         *  Closes bitrate menu by simulating click event on Reset button.\n        */\n        this.init = async () => {\n            await this.invoke_bitrate_menu();\n            //this.reset_button.click()   <-- alternative way of closing the menu but it also resets the bitrates\n            simulate_bitrate_menu_hotkey(); // Close bitrate menu after initialization is finished\n        };\n        /**\n         *  Invokes bitrate_menu and reassigns HTML elements\n         *  Reassigning elements is important because bitrate menu is removed from DOM tree\n         *  after overriding bitrate value or reseting\n        */\n        this.invoke_bitrate_menu = async () => {\n            this.logger.log(\"Invoking bitrate menu...\");\n            // Invoke bitrate menu and get html elements\n            this.bitrate_menu_elements = await invoke_bitrate_menu_and_get_html_elements();\n            this.available_bitrates = this.bitrate_menu_elements.bitrate_values;\n            this.override_button = this.bitrate_menu_elements.override_button;\n            this.reset_button = this.bitrate_menu_elements.reset_button;\n            this.select = this.bitrate_menu_elements.select;\n            this.logger.log(\"Bitrate menu invoked.\");\n        };\n        /**\n         * Returns array of available bitrate values\n         * @returns {Array<number>} Available bitrate values\n        */\n        this.get_available_bitrates = () => {\n            return this.available_bitrates;\n        };\n        /**\n         * Returns HTML elements of bitrate menu\n         * @returns {T_BITRATE_MENU_ELEMENTS}\n        */\n        this.get_bitrate_menu_elements = () => {\n            if (this.bitrate_menu_elements) {\n                return this.bitrate_menu_elements;\n            }\n        };\n        /**\n         * Method checks if provided bitrate is available in bitrate menu.\n         * If it is then the same value is returned.\n         * If not - the closest value is found and returned.\n         * @param {number} bitrate\n         * @returns {number} Returns closest available bitrate to provided value\n        */\n        this.check_bitrate_availability = (bitrate) => {\n            if (this.available_bitrates.includes(bitrate)) {\n                return bitrate;\n            }\n            else {\n                this.logger.log(\"Provided bitrate is not available. Finding closest value...\");\n                const closest_bitrate = this.available_bitrates.reduce((prev, curr) => {\n                    return (Math.abs(curr - bitrate) < Math.abs(prev - bitrate) ? curr : prev);\n                });\n                this.logger.log(`Closest bitrate to ${bitrate} is ${closest_bitrate}`);\n                return closest_bitrate;\n            }\n        };\n        this.available_bitrates = [];\n        this.logger = new CustomLogger(\"[BitrateMenu]\");\n    }\n    /**\n     * Overrides current bitrate with new bitrate value\n     * provided as a parameter\n     * @param {number} bitrate\n    */\n    async set_bitrate(bitrate) {\n        if (this.select && this.override_button) {\n            console.log(select);\n            console.log;\n            this.logger.log(`Setting bitrate to: ${bitrate}`);\n            this.select.value = bitrate.toString();\n            this.logger.log(`SELECTED BITRATE VALUE: ${this.select.value}`);\n            this.override_button.click();\n        }\n    }\n}\n","import { simulate_bitrate_menu_hotkey } from \"../keyboard_hotkeys/simulate_bitrate_menu_hotkeys.js\";\n/**\n * Function executes subfunction in intervals until bitrate menu elements are retrieved\n * and HTML elements are extracted using extract_html_elements method\n*/\nexport const invoke_bitrate_menu_and_get_html_elements = async () => {\n    return new Promise((resolve) => {\n        let timer;\n        timer = setInterval(() => {\n            // Simulate bitrate menu hotkey\n            simulate_bitrate_menu_hotkey();\n            try {\n                const bitrate_menu_elements = extract_html_elements();\n                const bitrate_values = bitrate_menu_elements.bitrate_values;\n                const override_button = bitrate_menu_elements.override_button;\n                const reset_button = bitrate_menu_elements.reset_button;\n                // Set opacity of the element to required value\n                if (bitrate_values.length > 0 && override_button != null && reset_button != null) {\n                    clearInterval(timer);\n                    resolve(bitrate_menu_elements);\n                }\n            }\n            catch (err) {\n                console.log(err);\n            }\n        }, 500);\n    });\n};\n/**\n * Helper method used to extract HTML elemnets from DOM tree\n * @returns{object} Object of key:values where values are HTML elements, possible to unpack\n*/\nconst extract_html_elements = () => {\n    // Get outter menu container\n    const container = [...document.querySelectorAll(\"div\")].filter(item => item.innerText.match(\"Video Bitrate\"))[1];\n    const override_button = [...document.querySelectorAll(\"button\")].filter(button => button.innerText.match(\"Override\"))[0];\n    const reset_button = [...document.querySelectorAll(\"button\")].filter(button => button.innerText.match(\"Reset\"))[0];\n    // Get bitrate menu container\n    const bitrate_menu_div = container.childNodes[1];\n    const select = bitrate_menu_div.childNodes[1];\n    const options = Array.from(bitrate_menu_div.childNodes[1].childNodes);\n    const bitrate_values = Array.from(bitrate_menu_div.childNodes[1].childNodes).map(option => {\n        const o = option;\n        return parseInt(o.value);\n    });\n    return {\n        container: container,\n        override_button: override_button,\n        reset_button: reset_button,\n        select: select,\n        options: options,\n        bitrate_values: bitrate_values\n    };\n};\n","__webpack_require__.h = () => (\"07cac183377d9e636b17\")","__webpack_require__.hmd = (module) => {\n\tmodule = Object.create(module);\n\tif (!module.children) module.children = [];\n\tObject.defineProperty(module, 'exports', {\n\t\tenumerable: true,\n\t\tset: () => {\n\t\t\tthrow new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);\n\t\t}\n\t});\n\treturn module;\n};"],"names":[],"sourceRoot":""}